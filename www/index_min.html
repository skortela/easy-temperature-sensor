<!DOCTYPE html><html lang="en"><head> <meta charset="UTF-8"> <meta name="viewport" content="width=device-width, initial-scale=1"/> <title></title> <link rel="icon" href="data:,"></head><body><style>.block_main{margin: auto; width: 60%; /* border: 5px solid #FFFF00; */ padding: 10px; font-size: x-large;}.block_container{text-align:left; padding-top: 15px;}.block_right{display:inline;}.block_right_green{display:inline; color: green;}.block_right_red{display:inline; color: red;}.block_left{display:inline-block; width: 200px; /* border: 5px solid #FFFF00; */}</style><div class="block_main"> <div class="block_container"> <h1></h1><br><div class="block_left">MQTT status:</div><div class="block_right" id="mqtt_status"></div></div><div class="block_container" id="sensors"></div></div></body><script>function refreshTimeout(){"visible"===document.visibilityState&&(reloadData(),setTimeout(refreshTimeout,5e3))}function reloadData(){fetch("wstatus").then(e=>{if(200===e.status)e.json().then(e=>populateByJson(e));else{if(401!==e.status)throw"http_err";location.reload()}}).catch(e=>{document.getElementById("mqtt_status").innerText="",document.getElementById("sensors").innerHTML="<p>Network error!</p>"})}function populateByJson(e){document.title=e.hostname,document.querySelector("h1").innerHTML=e.hostname;let t=document.getElementById("mqtt_status");t.innerText=e.mqtt_status,"connected"==e.mqtt_status?t.className="block_right_green":t.className="block_right_red";let n=document.getElementById("sensors");n.innerHTML="";let o=e.sensors;if(o.length>0)for(i=0;i<o.length;i++){let e=document.createElement("div");e.className="block_container";let t=document.createElement("div");t.className="block_left",t.textContent=o[i].name+": ",e.appendChild(t),t=document.createElement("div"),!0===o[i].available?(t.textContent=o[i].temperature+" â„ƒ",t.className="block_right"):(t.textContent="Not connected",t.className="block_right_red"),e.appendChild(t),n.appendChild(e)}else n.innerHTML="<p>No sensors connected!</p>"}window.onload=function(){refreshTimeout()},document.addEventListener("visibilitychange",function(){"visible"===document.visibilityState&&refreshTimeout()});</script></html>